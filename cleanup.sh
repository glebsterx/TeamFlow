#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∏ ContainerConfig –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

echo "üßπ –û—á–∏—Å—Ç–∫–∞ Docker –æ–∫—Ä—É–∂–µ–Ω–∏—è..."

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
echo "–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤..."
docker-compose down

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
echo "–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤..."
docker rm -f teamflow-backend teamflow-frontend 2>/dev/null || true

# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—Ä–∞–∑–æ–≤
echo "–û—á–∏—Å—Ç–∫–∞ –æ–±—Ä–∞–∑–æ–≤..."
docker image prune -f

# –£–¥–∞–ª–µ–Ω–∏–µ volume (–û–°–¢–û–†–û–ñ–ù–û: —É–¥–∞–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ!)
read -p "‚ö†Ô∏è  –£–¥–∞–ª–∏—Ç—å volume —Å –¥–∞–Ω–Ω—ã–º–∏? (y/N): " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    docker volume rm teamflow_teamflow-data 2>/dev/null || true
    echo "‚úì Volume —É–¥–∞–ª–µ–Ω"
fi

echo ""
echo "‚úÖ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo ""
echo "–¢–µ–ø–µ—Ä—å –∑–∞–ø—É—Å—Ç–∏—Ç–µ:"
echo "  docker-compose up --build -d"
